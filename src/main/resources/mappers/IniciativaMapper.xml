<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="edu.eci.cvds.persistence.mybatisimpl.mappers.IniciativaMapper">

    <resultMap type='Iniciativa' id='IniciativaResult'>
        <result property='nombrePropuesta' column='nombrePropuesta'/>  
		<result property='descripcion' column='descripcion'/>
		<result property='fechaInicio' column='fechaInicio'/>
		<result property='area' column='area'/>
		<association property='usuario' javaType='Usuario' resultMap='edu.eci.cvds.persistence.mybatisimpl.mappers.UsuarioMapper.UsuarioResult'></association>
		<association property='estado_Propuesta' javaType='Estado' resultMap='edu.eci.cvds.persistence.mybatisimpl.mappers.IniciativaMapper.EstadoResult'></association>
    </resultMap>  
    
	<resultMap type='Estado' id='EstadoResult'>     
        <result property='estado' column='estado'/>
    </resultMap>
	

	<select id="consultarTodasLasPropuestas" resultMap="IniciativaResult" parameterType="map">
		SELECT 
	    nombrePropuesta,
		descripcion,
		fechaInicio,
		area,
		usuario,
		estado,
		FROM iniciativa;
    </select>
	
	<insert id="insertarIniciativa" parameterType="Iniciativa">
		INSERT INTO Iniciativa (nombrePropuesta, descripcion, fechaInicio, area, usuario, estado_Propuesta) 
		VALUES((#{nombrePropuesta}, #{descripcion}, #{fechaInicio}, #{area}, #{usuario}, #{estado_Propuesta})
	</insert>
	
	<select id="consultarPropuestaPorUsuario" resultMap="IniciativaResult" parameterType="map">
		SELECT 
	    i.nombrePropuesta,
		i.descripcion,
		i.fechaInicio,
		i.area,
		i.usuario,
		i.estado,
	    FROM iniciativa as i
		WHERE i.usuario_correo = #{correo};
    </select>
  
	
</mapper>
